package Exploit.org;

import javax.swing.*;
import java.util.LinkedList;
import java.util.ListIterator;

public class Playlist {
    private String playListName;
    private final LinkedList<Track> playlist = new LinkedList<>();

    public Playlist(String playListName) {
        this.playListName = playListName;
    }

    public void setPlayListName(String playListName) {
        this.playListName = playListName;
    }

    public String getPlayListName() {
        return playListName;
    }

    public LinkedList<Track> getPlaylist() {
        return playlist;
    }

    public boolean renamePlaylist() {
        Icon icon = new ImageIcon("src/Exploit/org/Trackstore/WaveFX.png");
        String[] option = {"Rename"};
        String response = (String) JOptionPane.showInputDialog(null,
                "Enter a new name for the Playlist : ",
                "WaveFX",
                JOptionPane.INFORMATION_MESSAGE,
                icon,
                null,
                null);
        if (response == null) {
            return false;
        }
        this.setPlayListName(response);
        return true;
    }

    public boolean playThisPlaylist() {
        ListIterator<Track> playListIterator = this.playlist.listIterator();
        int flag = 0;
        boolean isGoingForward = true;
        if (playListIterator.hasNext()) {
            flag = playListIterator.next().waveFxPlayer();
        }
        while (flag != 0) {
            if (flag == 1) {
                if (isGoingForward) {
                    if (playListIterator.hasPrevious()) {
                        playListIterator.previous();
                    }
                    isGoingForward = false;
                }
                if (playListIterator.hasPrevious()) {
                    flag = playListIterator.previous().waveFxPlayer();
                } else {
                    //This is the start of the list or Head element of the linked list.
                    flag = playListIterator.next().waveFxPlayer();
                }
            }

            if (flag == 5) {
                if (!isGoingForward) {
                    if (playListIterator.hasNext()) {
                        playListIterator.next();
                    }
                    isGoingForward = true;
                }
                if (playListIterator.hasNext()) {
                    flag = playListIterator.next().waveFxPlayer();
                } else {
                    //This is the End of the list.
                    flag = playListIterator.previous().waveFxPlayer();
                }
            }
            if (flag == 0) {
                return true;
            }
        }
        return false;
    }

    public boolean playTrackFromPlaylist() {
        Icon icon = new ImageIcon("src/Exploit/org/Trackstore/WaveFX.png");
        String response = (String) JOptionPane.showInputDialog(null,
                "Select track from Playlist to Play : ",
                "WaveFX",
                JOptionPane.INFORMATION_MESSAGE,
                icon,
                this.trackArrayList(),
                null);
        if (response == null) {
            return false;
        }
        ListIterator<Track> playListIterator = this.playlist.listIterator();
        while (playListIterator.hasNext()) {
            if (playListIterator.next().getTrackName().equals(response)) {
                int flag = playListIterator.previous().waveFxPlayer();
                if (flag == 1 || flag == 5) {
                    this.playThisPlaylist();
                }
                return true;
            }
        }
        return false;
    }

    private String[] trackArrayList() {
        String[] trackListArray = new String[this.playlist.size()];
        ListIterator<Track> playListIterator = this.playlist.listIterator();
        for (int i = 0; i < this.playlist.size(); i++) {
            trackListArray[i] = playListIterator.next().getTrackName();
        }
        return trackListArray;
    }

    public boolean removeTrackFromPlaylist() {
        Icon icon = new ImageIcon("src/Exploit/org/Trackstore/WaveFX.png");
        String response = (String) JOptionPane.showInputDialog(null,
                "Select track to remove from Playlist : ",
                "WaveFX",
                JOptionPane.INFORMATION_MESSAGE,
                icon,
                this.trackArrayList(),
                null);
        if (response == null) {
            return false;
        }
        ListIterator<Track> playListIterator = this.playlist.listIterator();
        while (playListIterator.hasNext()) {
            if (playListIterator.next().getTrackName().equals(response)) {
                playListIterator.remove();
                return true;
            }
        }
        return false;
    }

}
